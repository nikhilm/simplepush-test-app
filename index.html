<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="pragma" content="no-cache">
    <title>Push</title>

    <style>
      html, body {
        width: 100%;
        height: 100%;
        background-color: gray;
      }
    </style>

    <script>
/*
      navigator.mozSetMessageHandler('push', function(e) {
        var notification = window.navigator.mozNotification.createNotification('Push notification', 'From the template application');
      
        notification.onclick = function test_notificationClick() {
          alert("Got system message! ");
        };
      
        notification.show();
      });


      }
*/
      function register() {
        var req = navigator.pushRegistrationManager.register()
        .then(
          function(endpoint) {
            document.getElementById("registration").innerHTML = endpoint
          },
          function(e) {
            document.getElementById("registration").innerHTML = endpoint 
          }
        )
      }

      function isRegistered(){
        var req = navigator.pushRegistrationManager.isRegistered()
        .then(
          function(isRegistered){
            document.getElementById("isRegistered").innerHTML = isRegistered          
          },
          function(error){
            document.getElementById("isRegistered").innerHTML = error
          }
        );
      }

      function unregister() {
        navigator.pushRegistrationManager.unregister()
        .then(
          function(e){
            document.getElementById("registration").innerHTML = "No Registration"
          },
          function(error){
            document.getElementById("registration").innerHTML = error
          }
        );

      }

      function hasPermission(){
        navigator.pushRegistrationManager.hasPermission()
        .then(
          function(hasPermission){
            document.getElementById("hasPermission").innerHTML = hasPermission;
          },
          function(error){
            document.getElementById("hasPermission").innerHTML = error;
          }
        );
      }

    </script>
  </head>

  <body >
    <p>Push Notifications</p>

    <button onclick="register();">Register!</button>
    <button onclick="unregister();">unregister</button>
    
    <div id='registration'>No Registration</div>

    <button onclick="isRegistered();">isRegistered</button>
    <div id='isRegistered'>isRegistered</div>

    
    <button onclick="hasPermission();">hasPermission</button>
    <div id='hasPermission'>hasPermission</div>

  </body>

</html>
